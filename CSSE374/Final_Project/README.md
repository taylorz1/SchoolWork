![alt text](http://www.plantuml.com/plantuml/svg/vLhTRwis57_dhq3R7kYML9esQIzLjDpST8lKj55pEscQzk0GDs45pC14j_luttVyWJ5W3APtUzbB2_Zu-FXy_ewTxmkASbeciLUyH6c6SfJuSPHY-ffXd-JqJBmmHaNXXqM1l_dks-jTJdx38Rr-n36Y4KaV3kpLz__qvlwUvb5wyfzpajHlbC3pEYsJ6_Qd-8BzNVYCl_TLHNF2z1Oc1LUDJny8_z2PouPWEX-yaEZe5_93cv8H70Y9CKfz_7k9uY8GuchhK28UWDlVFLlTbOSu2c-ZcEASRRHc-io_1Nj2w8fDlJAFRJ7eyTWpU1lX-DY_-9OSSIpKUnSLz6PvA6YEGhfCKVpw1yaNVaZIv-WanxTbJAC4PJTYLpEntuMVC3Rh62SufGK8iY9n30DWGAREhJOQo9bgGzB2GBQ7xp7ke-EcGCUZYLcbzhcWod52BjX6gFl13j5popMsA4hvmgtl_1jkVtqFomMwYCfWJTDLphGFSOe3_fSpOWzy__oxpWX40pkcWVpFXkJZdf8SI-dLUyDb6mFwYoB27t5OKZ5hZ-cD4fR7GBq9NQ8gBeDcWEhE5vvn-6AXqqnaeM82DRzogQfFRHk86DX7fnJHigM9fpIYF-GeEmVgYGsh5pQ_fcdRDkFUqOuVnEC3vyNr9ZtZFA8e3N4LD2AAXSe4NS2TqSQ6ET4c1ICzexSnOdOpp3-KKNmK7iPPpFZpE_OLvpP-ow8WOSILhhETjrscW4VEeqTYcM0CDjLMq0DchZoAiLwHb49K5ZAI5J_noldmLFS3x2gFGblkMyOd0XOx9u-u8F65RV977EKe3y-lGYmvy0wVqIMgr2YMK_bs0JxCgRXNpUg1cJ8HaidKx_UTY0xR-Yl_puhJtoEDERWob1lSD2VxmWe7xf7YyuuKpuf79GRZCMfvcO_UOuh3XWO-zqL5uWLbj2H7pYSOPUhgIIjwcvQz5_v1FXL0iW4NGnIVNlr2FanmXZg3Lei4xLKR5KIk5AZ5xId8a3Sc16XFpbNizUZiQ5ekNUq6N0nTIBuYIVO0scPPKW-dkGOHRgGtBFnCF1HWOk7d-1aA5b_nNKp25-bc3oNDIWgQmIYvgcZHCqnr9Qt2fzgNXLxOSv2t47c8kD-MJzix6LEQXxPX5n1Lolo0ammiXfi-spEfCcvtSevZPJdD3uK-Au_jNzq44GpJ-jPNskjFAKFU9i0Z9QacdKYfOnmDKGTt-1zwvICWnRo8BYraqiumPGQrjyeMlMc6VwtHjE8TlpRBFwVZQF8d54T7M_RHu4_b1wAsD8ktn0fSJhbwfI5LGchOSKO5Hn06gKG1Lcm2dVtCY660sPw2yuURjE1WKHZ337WIH67VnJ9zvMlmxhF6FHhBNHvT87u0745jAjbscrfInZ1LZQOjspMr0pYxl0pLTME4JXflTnJLNRTgNZTwqwojOUkVxMHrAssd6-gg0QbAgGfkTAdJ1BvBG_xogysBLUqaHSGoLzEPJNKwb-yMVuwAXnob9zpfjcgI446k58wjwMEcgyRMmcGuFU8qV1s9G-RMdVJZb6rTrDu9mHUoLvFhExKHZRwrqOk89UG_IMPPNsyzXhMrnx-NE6rZDXtzzciELxghCbe82PpYuqeDTkBmqAxkq1XReEX0FPvNFFGzu1znp1n7Bogp3OGC0i-zOV6zc44mpvfwhGqX3YKkA2vXBvlqyhB-cEKYBy0RUS7ilL6oAXx0jMu8kxb5fbgnWLQUKSWbop6bhpjMlyH8eHoW3WI-cqECzLMkwiF8ZCtUiLFEek45Yg2eZ7aRWQUApPaag9PMwt7jCKeOPBvs5wNulamEYiU8fgjzjYVwBT41YKowa3bEXu1YH9QuYkvgJC4mvqP-WCgMxZqFpJ4yXXWYiKeW8KeXjFn2_6z6e0e1Vau90pq1IZ8Mr9tnrix5k0a-Tqz6aNogvwXupA8CitDkBdpTcdFxTw9SbwRJYO9B9JgoruchtX14EPqE1lY-F9sgqXoq9pNE6M6H3c5VUve9umGgP1FkvP8Sib8zehcF-YPY98VQfX6UMEe4iRXY0lD9z5N_6NK48R2JAWyKdJ8j6nRFzOfWxbYuJD3AG91TO2yP5A3em21fCqrfofNB1pqEejC-PEBGigxzxR6Wky2gALvxmCnDxhFftPRBXvmmd82F__7zWm4whW1xy2FOJtBwPgW6K9kW2qeO1C0VwHwd35jTy8vmXCdDLaI5E9ZlbWdxqIs7J6yvjdraq2LlWW617VqxSZg1QMB-pxLJre_yqgFOpB2SLIYGh6JzEIITm91JPsEWBDFEfpoFvfhcWsyyxMfTCR8h3s0Tjkzjh7MCNmIANKbZQPytzn_MZxVBrTeukd_QhHzNTylztZWCtnzMc-M7pSEzSVpzUhU-Vx--N_qyD7sxlFzvW0KdcNT9VldLNzy_RR_uQNdtjDxhxKo3Xa4sUIjc81333yygaVNd8jxC_lkPoDIjNLyl1YvJl75t8upHPr_3F__BpmQkjJtpRUmK3kvt6lg66-ixwQTzsk9PqPpEn5bYRmIYdSyjgfF5q1jv-JQV_xKOWQAzWPykM4MgeyIkECR4RYpRRS2mgIqMxL63yGR76xYET154lnjpDSLmX8xp_8uDHllMYDZfdAbw8mu9T4SOSVpcsM_-fklLTEizh5UNIo8NNz4kJNgsfE_Q6uEDfgkc2mTTjjAPFLqG0-1paQJt3D8Q23troHgHRt73DoPjIpXEpV-jbkhw-g-5GoaoP--fWCAb-lRrNyCvRTnjd3SAoplLgbPsT8dzGGsPVfut0e8qp6suR9bGOnnyprfkz0RJPMRtNDyRYGS-QNsP6e-MdVMbE3Vj6B2ZAuD6ndV8nPF0MRFRcEfoVPur9GWjsZ6KYmant4p9WtiO0sLSsvT6Od21RbDoUVNaZVaXb1iyQUU2Vo4iksLXeB7eaK5l8JpxoTGq3kQViRaqQrQ0xswCQOwhFC6O2wQr6URVipfLzuuNkBgQ0yYP79sstyYuD9hQqPSZOZHumHI4FY8kXylSC9YPfjkHGD5rQmxzgBthdDJx6d-ovjehlYtoU-zS75nNmyUZF7TC0MXbnJ79wytrTG2YZIzafc1mGgMTljspN3vCFL-q2A0vzXIifQKoxtj8JMKI_mC0)

# Run Project
# How to Install our project
Simply clone the repo and add it to your favorite gradle compatible IDE. Then run the gradle build task and then run the gradle run task.

# How do I extend your project?
If you wish to make any improvements to the general codebase feel free to simply branch our project and then make a merge request. We'll review the changes. 

If you are trying to modify our project so that you can make it do something new and exciting feel free to add 
analyzors or renderers to the project by calling the addAnalyzor method in your preprocessor object. All analyzors must extend FileAnalyzor. A new renderer is treated the same as a new analyzor. To actually cause the program to use your analyzor you will probably have to add a new flag for the project to reference it with. Or calling addConfig which will allow your program to take in input as neccessary.

If you are attempting to add a new type of filter you must make your object implement the IFilter interface. Then you must add it to the preprocessor by calling addFilter.

If you are attempting to add a new pattern simply construct the pattern object in your detector and register it to the model using the model.addPattern() method. Make sure the strings you use to name your pattern are the strings you use to access it from elsewhere.

# What do the flags mean?
-dir					- This sets the directory to operate in  
-demo 					- This odd flag sets the -dir, -classes, and -main flags to default  
						  and takes in input on what class (with or without a main method) to run on.  
-classes				- This is a comma delimiter list of fully qualified class names for the project to run on  
-f						- This filters output based on specified argument. Usage -f filterName  
-main					- This sets the main class of the project (must contain a main method)  
-depth					- This specifies the depth of the sequence analyzer  
-sig					- This 3 part arguments e.g. -sig className,methodName,params1,params2,...  
-sigdir					- This flag is the equivalent of dir for sequence diagrams  
-recur                                  - Activate this function by puting "y" after the flag. This flag will recursively analysis the passed in classes  
-superclass                             - Activate this function by puting "y" after the flag. This flag will analysis the superclass relations between classes  
-interface                              - Activate this function by puting "y" after the flag. This flag will analysis the interface relations between classes  
-dependency                             - Activate this function by puting "y" after the flag. This flag will analysis the dependency relations between classes  
-association                             - Activate this function by puting "y" after the flag. This flag will analysis the association relations between classes  
-pattern                             - This flag is setting the desired pattern to detect. To use this flag, put the patterndetector you want to analyze after the flag, separate by ","  
-agg                                 - This flag is setting the aggregation function for finding abstract method of sequence diagram  
-methods                                 - This flag is setting the prim algorithms for the aggregation function for finding abstract method of sequence diagram  
-methodResolver                          - This flag is setting the prim algorithms if you don't want to use aggregation. Defaultly set to callgraph  

Examples are below

## Demo 1-1 Lab1-1
-dir /Users/KrystalYang/Desktop/Study/CSSE374/Homework/Lab1-1/build/classes/main/ -main problem.Main -classes problem.Main,problem.AmazonParser,problem.DataStandardizer,problem.GoogleParser,problem.GrouponParser,problem.ILineParser,problem.MicrosoftPaser,problem.StandardizerUI
## Demo 1-2 java.lang.String
-demo java.lang.String -interface
## Demo 1-3 java.swing.JComponent
-demo javax.swing.JComponent -recur
## Demo 1-4 our project
-dir /Users/KrystalYang/Documents/CSSE374/RevEngD/build/classes/main/ -main csse374.Project.Main -classes csse374.Project.Main,csse374.Project.FileAnalyzor,csse374.Project.ClassAnalyzor,csse374.Project.DemoAnalyzor,csse374.Project.DemoInterfaceAnalyzor,csse374.Project.IAnalyzor,csse374.Project.IFilter,csse374.Project.InitAnalyzor,csse374.Project.Model,csse374.Project.PreProcessor,csse374.Project.PrivateFilter,csse374.Project.PublicFilter,csse374.Project.ProtectedFilter,csse374.Project.RecursiveAnalyzor,csse374.Project.RelationshipAnalyzor,csse374.Project.RenderAnalyzor,csse374.Project.UMLAnalyzer,csse374.Project.SootAnalyzor -f public

## Demo 2-1 Generating a Sequence Diagram
-sigdir /Users/KrystalYang/Documents/CSSE374/Lab2-1/build/classes/main/ -main headfirst.designpatterns.observer.weather.WeatherStation -sig headfirst.designpatterns.observer.weather.WeatherStation,main,java.lang.String[]  

Optionally you may add a -depth # where # is the intended depth of recursion on method calls. By default this value is 5.

# TeamContribution
M1  
Together: Preprocessor and Model; Refactor the project to satisfy the design principles we learned from class; added a bunch of command args. Changed build.gradle
Zachary Taylor: Add all classes; Implement the Filter function; Implement the PlanUMLAnalyzor and RenderAnalyzor; Add the PlantUML graph generate function; 
Krystal Yang: Add RecursiveAnalyzor; Add DemoInterfaceAnalyzor; Add DemoAnalyzor; Add SootAnalyzor; Remade some of the logic in the Preprocessor, reorganized filtering functionality.   
M2  
Together: Main, Model, SequenceAnalyzer
Zachary Taylor: SequenceAnalyzer
Krystal Yang: Association and Dependency analyzers  
M3  
Zachary Taylor: Algorithm Resolver, Singleton Detector, Refactoring the project  
Krystal Yang: Bidirection Detector, FavorCompositionOverInheritence Detector, Pattern Detector  
M4  
Zachary Taylor: Refactoring, BadDecoratorDetector, Readme document, Making jar file and testing  
Krystal Yang: DecoratorDetector, AdapterDetector, DependencyInversionDetector  

# Reverse-Engineered Design (RevEngD)

[![build status](https://ada.csse.rose-hulman.edu/CSSE374-Public/RevEngD/badges/master/build.svg)](https://ada.csse.rose-hulman.edu/CSSE374-Public/RevEngD/commits/master)
[![coverage report](https://ada.csse.rose-hulman.edu/CSSE374-Public/RevEngD/badges/master/coverage.svg)](https://ada.csse.rose-hulman.edu/CSSE374-Public/RevEngD/commits/master)

This is a starter repository for **Software Design - CSSE 374** term project. This application reverse engineers the design of a supplied codebase using [SOOT](https://github.com/Sable/soot), a bytecode instrumentation framework. You will need to learn a few things about SOOT to do a good job in the project. Use these references whenever you get stuck:
1. [SOOT Survival Guide PDF](http://www.brics.dk/SootGuide/sootsurvivorsguide.pdf)
2. [Fundamental Soot Objects](https://github.com/Sable/soot/wiki/Fundamental-Soot-objects)
3. [Other Online Help](https://github.com/Sable/soot/wiki/Getting-help)

## About Seed Contents
The repo, as is, contains four examples for you to try out and expand. Lets' take a quick tour of the repo contents:

1. [SceneBuilder API](/src/main/java/csse374/revengd/soot/SceneBuilder.java) - Helps with setting up SOOT for a whole program analysis.
2. [Examples / Todos](/src/main/java/csse374/revengd/examples/driver)  - There are four examples for you to **review and expand upon** in the [csse374.revengd.examples.driver](/src/main/java/csse374/revengd/examples/driver) package:
   * **SimpleDirectoryLoading** - Shows how to load Java classes from a directory in SOOT and prints the fields and methods of the classes.
   * **TypeHierarchy** - Shows how to use the type hierarchy provided by SOOT.
   * **ControlFlowGraph** - Shows how to get the statements inside a method and search for specific method calls from within the method.
   * **PointerAnalysis** - Shows how to resolve dynamic dispatch target(s) of a method call statically using pointer analysis. 
   * **ExamplesDriver** - Implements REPL to drive the above four examples from command prompt.
3. [Fixtures](/src/main/java/csse374/revengd/examples/fixtures) - Contains a sample calculator application for running test and examples.

Each example has some **TODOs** for you to complete. Please complete them to solidify your understanding of the concepts.

## Cloning the Repo
You can clone the repo locally using Git Bash/Shell as follows:
```bash
cd <to the your workspace folder>
git clone git@ada.csse.rose-hulman.edu:CSSE374-Public/RevEngD.git
```

## Using IDE
You can import the cloned folder as a **Gradle Project** in Eclipse or IntelliJ IDEs.

## Running the Examples
### Running From Command Line
```bash
cd RevEngD
./gradlew run
```
It should present the following prompt:
```bash
========================= Your choices ========================= 
1 - E1SimpleDirectoryLoading
2 - E2TypeHierarchy
3 - E3ControlFlowGraph
4 - E4PointerAnalysis
========================== End choices ========================= 
Please enter your choice (number) or press q to quit: 
```
Enter the number corresponding to the example that you want to run, sit back, and enjoy the ride. Make sure you review the code in the project before running the examples. 

### Running From Eclipse/IntelliJ
In your IDE, open the Gradle Tasks view and double-click on the **run** task under **application**. 

## Other Notes
The project is configured to use Log4J, which you can also use for your own classes. See [SceneBuilder API](/src/main/java/csse374/revengd/soot/SceneBuilder.java) for an example. 

## Helpful Notes
For the template method of UMLBehavior all afterX methods should end with a newline character or else your uml will fail to parse correctly.
If you want to create a new pattern you must first create a pattern detector anaylzer, then that must attempt to add a pattern object to the model using the model.addpattern(). Then you must make a pattern renderer and register it to your umlAnalyzer behavior list. You must make a pattern renderer for both class attributes and relationship attributes. Remember to use typical plantUML syntax in these renderers.
Furthermore for any note if for some reason you have encountered a bug when the stereotype is being defined multiple times inside of your uml file, this is a known bug. This bug occurs because the template method for afterClassBlock and beforeClassBlock lack the actual scope to live outside of a single class rendering. This will be fixed in a future release, but is a very low priority bug as there is no current conceivable way of this impacting a rendering negatively. 
